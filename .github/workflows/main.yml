name: Deploy
on:
  push:
    branches:
      - main

jobs:
  deploy:
    name: deploy
    runs-on: ubuntu-latest
    steps:
      - name: Checkout the files
        uses: actions/checkout@v3

      # - name: Copy files with SSH
      #   uses: easingthemes/ssh-deploy@main
      #   env:
      #     SSH_PRIVATE_KEY: ${{secrets.SSH_KEY}}
      #     ARGS: "-rlgoDzvc --delete"
      #     SOURCE: "./"
      #     REMOTE_HOST: ${{secrets.REMOTE_HOST}}
      #     REMOTE_USER: ${{secrets.REMOTE_USER}}
      #     TARGET: ${{secrets.TARGET_DIR}}
      #     EXCLUDE: "/dist/, /node_modules/, **.env, rebuild_app.sh, watcher.sh"
      - name: Connect to the actuated SSH gateway
        uses: invi5H/ssh-action@v1
        with:
          SSH_HOST: ${{ secrets.SSH_HOST }}
          SSH_PORT: "22"
          SSH_USER: ${{ secrets.SSH_USER }}
          SSH_KEY: ${{ secrets.SSH_KEY }}
      - run: ssh ${{ steps.ssh.outputs.SERVER }} pwd
